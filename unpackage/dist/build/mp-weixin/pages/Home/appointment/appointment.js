(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/Home/appointment/appointment"],{"0d8b":function(e,t,c){},"2b24":function(e,t,c){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=c("9fd2"),a=c("955d"),i=c("2f62");function l(e,t){var c=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),c.push.apply(c,n)}return c}function s(e){for(var t=1;t<arguments.length;t++){var c=null!=arguments[t]?arguments[t]:{};t%2?l(Object(c),!0).forEach((function(t){r(e,t,c[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(c)):l(Object(c)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(c,t))}))}return e}function r(e,t,c){return t in e?Object.defineProperty(e,t,{value:c,enumerable:!0,configurable:!0,writable:!0}):e[t]=c,e}var d=function(){c.e("components/s-pull-scroll/index").then(function(){return resolve(c("bfe4"))}.bind(null,c)).catch(c.oe)},o={components:{sPullScroll:d},data:function(){return{show:!1,currentArea:{},currentObj:{},currentKeyword:-1,moneyDetail:{weekMoney:{},weekendMoney:{}},show1:!1,weekTime:[{time:"7:00",id:0,price:5,areaNames:[{id:0,name:"一号场地",select:!1,canSelect:!0,surplus:0},{id:1,name:"二号场地",select:!1,canSelect:!0,surplus:0},{id:2,name:"三号场地",select:!1,canSelect:!0,surplus:0},{id:3,name:"四号场地",select:!1,canSelect:!0,surplus:0}]},{time:"10:00",id:3,price:30,areaNames:[{id:0,name:"一号场地",select:!1,canSelect:!0},{id:1,name:"二号场地",select:!1,canSelect:!0},{id:2,name:"三号场地",select:!1,canSelect:!0},{id:3,name:"四号场地",select:!1,canSelect:!0}]},{time:"11:00",id:4,price:30,areaNames:[{id:0,name:"一号场地",select:!1,canSelect:!0},{id:1,name:"二号场地",select:!1,canSelect:!0},{id:2,name:"三号场地",select:!1,canSelect:!0},{id:3,name:"四号场地",select:!1,canSelect:!0}]},{time:"12:00",id:5,price:30,areaNames:[{id:0,name:"一号场地",select:!1,canSelect:!0},{id:1,name:"二号场地",select:!1,canSelect:!0},{id:2,name:"三号场地",select:!1,canSelect:!0},{id:3,name:"四号场地",select:!1,canSelect:!0}]},{time:"13:00",id:6,price:30,areaNames:[{id:0,name:"一号场地",select:!1,canSelect:!0},{id:1,name:"二号场地",select:!1,canSelect:!0},{id:2,name:"三号场地",select:!1,canSelect:!0},{id:3,name:"四号场地",select:!1,canSelect:!0}]},{time:"14:00",id:7,price:30,areaNames:[{id:0,name:"一号场地",select:!1,canSelect:!0},{id:1,name:"二号场地",select:!1,canSelect:!0},{id:2,name:"三号场地",select:!1,canSelect:!0},{id:3,name:"四号场地",select:!1,canSelect:!0}]},{time:"15:00",id:8,price:30,areaNames:[{id:0,name:"一号场地",select:!1,canSelect:!0},{id:1,name:"二号场地",select:!1,canSelect:!0},{id:2,name:"三号场地",select:!1,canSelect:!0},{id:3,name:"四号场地",select:!1,canSelect:!0}]},{time:"16:00",id:9,price:30,areaNames:[{id:0,name:"一号场地",select:!1,canSelect:!0},{id:1,name:"二号场地",select:!1,canSelect:!0},{id:2,name:"三号场地",select:!1,canSelect:!0},{id:3,name:"四号场地",select:!1,canSelect:!0}]},{time:"17:00",id:10,price:35,areaNames:[{id:0,name:"一号场地",select:!1,canSelect:!0},{id:1,name:"二号场地",select:!1,canSelect:!0},{id:2,name:"三号场地",select:!1,canSelect:!0},{id:3,name:"四号场地",select:!1,canSelect:!0}]},{time:"18:00",id:11,price:35,areaNames:[{id:0,name:"一号场地",select:!1,canSelect:!0},{id:1,name:"二号场地",select:!1,canSelect:!0},{id:2,name:"三号场地",select:!1,canSelect:!0},{id:3,name:"四号场地",select:!1,canSelect:!0}]},{time:"19:00",id:12,price:35,areaNames:[{id:0,name:"一号场地",select:!1,canSelect:!0},{id:1,name:"二号场地",select:!1,canSelect:!0},{id:2,name:"三号场地",select:!1,canSelect:!0},{id:3,name:"四号场地",select:!1,canSelect:!0}]},{time:"20:00",id:13,price:35,areaNames:[{id:0,name:"一号场地",select:!1,canSelect:!0},{id:1,name:"二号场地",select:!1,canSelect:!0},{id:2,name:"三号场地",select:!1,canSelect:!0},{id:3,name:"四号场地",select:!1,canSelect:!0}]},{time:"21:00",id:14,price:35,areaNames:[{id:0,name:"一号场地",select:!1,canSelect:!0},{id:1,name:"二号场地",select:!1,canSelect:!0},{id:2,name:"三号场地",select:!1,canSelect:!0},{id:3,name:"四号场地",select:!1,canSelect:!0}]}],topMoney:5,centerMoney:30,bottomMoney:35,list:[],colorList:[{color:"#DCDCDC",text:"可选"},{color:"#E76446",text:"不可选"},{color:"#85BC3B",text:"已选"}],buttontext:"立即预约",selected:[],bootomheight:60,picker:["1人","2人","3人","4人","5人","6人","7人","8人","9人","10人"],pickerIndex:0,isWeekend:!1,weekendTime:[{time:"7:00",id:0,price:10,areaNames:[{id:0,name:"一号场地",select:!1,canSelect:!0,surplus:0},{id:1,name:"二号场地",select:!1,canSelect:!0,surplus:0},{id:2,name:"三号场地",select:!1,canSelect:!0,surplus:0},{id:3,name:"四号场地",select:!1,canSelect:!0,surplus:0}]},{time:"9:00",id:3,price:35,areaNames:[{id:0,name:"一号场地",select:!1,canSelect:!0},{id:1,name:"二号场地",select:!1,canSelect:!0},{id:2,name:"三号场地",select:!1,canSelect:!0},{id:3,name:"四号场地",select:!1,canSelect:!0}]},{time:"10:00",id:4,price:35,areaNames:[{id:0,name:"一号场地",select:!1,canSelect:!0},{id:1,name:"二号场地",select:!1,canSelect:!0},{id:2,name:"三号场地",select:!1,canSelect:!0},{id:3,name:"四号场地",select:!1,canSelect:!0}]},{time:"11:00",id:5,price:35,areaNames:[{id:0,name:"一号场地",select:!1,canSelect:!0},{id:1,name:"二号场地",select:!1,canSelect:!0},{id:2,name:"三号场地",select:!1,canSelect:!0},{id:3,name:"四号场地",select:!1,canSelect:!0}]},{time:"12:00",id:6,price:35,areaNames:[{id:0,name:"一号场地",select:!1,canSelect:!0},{id:1,name:"二号场地",select:!1,canSelect:!0},{id:2,name:"三号场地",select:!1,canSelect:!0},{id:3,name:"四号场地",select:!1,canSelect:!0}]},{time:"13:00",id:7,price:35,areaNames:[{id:0,name:"一号场地",select:!1,canSelect:!0},{id:1,name:"二号场地",select:!1,canSelect:!0},{id:2,name:"三号场地",select:!1,canSelect:!0},{id:3,name:"四号场地",select:!1,canSelect:!0}]},{time:"14:00",id:8,price:35,areaNames:[{id:0,name:"一号场地",select:!1,canSelect:!0},{id:1,name:"二号场地",select:!1,canSelect:!0},{id:2,name:"三号场地",select:!1,canSelect:!0},{id:3,name:"四号场地",select:!1,canSelect:!0}]},{time:"15:00",id:9,price:35,areaNames:[{id:0,name:"一号场地",select:!1,canSelect:!0},{id:1,name:"二号场地",select:!1,canSelect:!0},{id:2,name:"三号场地",select:!1,canSelect:!0},{id:3,name:"四号场地",select:!1,canSelect:!0}]},{time:"16:00",id:10,price:35,areaNames:[{id:0,name:"一号场地",select:!1,canSelect:!0},{id:1,name:"二号场地",select:!1,canSelect:!0},{id:2,name:"三号场地",select:!1,canSelect:!0},{id:3,name:"四号场地",select:!1,canSelect:!0}]},{time:"17:00",id:11,price:40,areaNames:[{id:0,name:"一号场地",select:!1,canSelect:!0},{id:1,name:"二号场地",select:!1,canSelect:!0},{id:2,name:"三号场地",select:!1,canSelect:!0},{id:3,name:"四号场地",select:!1,canSelect:!0}]},{time:"18:00",id:12,price:40,areaNames:[{id:0,name:"一号场地",select:!1,canSelect:!0},{id:1,name:"二号场地",select:!1,canSelect:!0},{id:2,name:"三号场地",select:!1,canSelect:!0},{id:3,name:"四号场地",select:!1,canSelect:!0}]},{time:"19:00",id:13,price:40,areaNames:[{id:0,name:"一号场地",select:!1,canSelect:!0},{id:1,name:"二号场地",select:!1,canSelect:!0},{id:2,name:"三号场地",select:!1,canSelect:!0},{id:3,name:"四号场地",select:!1,canSelect:!0}]},{time:"20:00",id:14,price:40,areaNames:[{id:0,name:"一号场地",select:!1,canSelect:!0},{id:1,name:"二号场地",select:!1,canSelect:!0},{id:2,name:"三号场地",select:!1,canSelect:!0},{id:3,name:"四号场地",select:!1,canSelect:!0}]},{time:"21:00",id:15,price:40,areaNames:[{id:0,name:"一号场地",select:!1,canSelect:!0},{id:1,name:"二号场地",select:!1,canSelect:!0},{id:2,name:"三号场地",select:!1,canSelect:!0},{id:3,name:"四号场地",select:!1,canSelect:!0}]}]}},onLoad:function(){this.allAppointment()},computed:s({},(0,i.mapState)(["isUserAuthorize","userInfo"]),{totalPrice:function(){var e=this,t=this.selected,c=t.filter((function(e,t){return 7==(0,a.dealTime)(e.start_time)})),n=t.filter((function(e,t){return 7!=(0,a.dealTime)(e.start_time)}));return 0!=c.length?c.reduce((function(t,c){return 1*t+c.price*e.dealPicker.replace("人","")}),0)+this.totalP(n):this.totalP(n)},dealPicker:function(){return this.pickerIndex>-1?this.picker[this.pickerIndex]?this.picker[this.pickerIndex]:this.picker[0]:"请选择人数"}}),methods:{totalP:function(e){return e.reduce((function(e,t){return 1*e+1*t.price}),0)},refresh:function(){var e=this;this.$nextTick((function(){e.$refs.pullScroll.refresh()}))},pullDown:function(e){var t=this;console.log("123"),this.selected=[],this.isWeekend?this.weekendTime.forEach((function(e){e.areaNames.forEach((function(e){t.$set(e,"select",!1)}))})):this.weekTime.forEach((function(e){e.areaNames.forEach((function(e){t.$set(e,"select",!1)}))})),this.allAppointment()},selectClick:function(e,t,c,n){if(console.log(e),e.canSelect){this.bottomHeigth();var a=(new Date).getHours();console.log(a);var i={address_id:1*e.id+1,start_time:c.time,end_time:this.isWeekend?this.weekendTime[n+1].time:this.weekTime[n+1].time,price:c.price};console.log(i),e.select?(e.select=!1,this.removeArr(i),0==n&&(this.picker=["1人","2人","3人","4人","5人","6人","7人","8人","9人","10人"])):c.time.replace(/:00/,"")==a?(this.currentArea=e,this.currentObj=i,this.currentKeyword=n,this.show=!0):this.addSelected(e,i,n)}},addSelected:function(e,t,c){e.select=!0,this.selected.push(t),this.orderSelect(),0==c&&(this.picker=["1人","2人","3人","4人"])},removeArr:function(e){var t=this.selected.findIndex((function(t){return t.address_id==e.address_id&&t.start_time==e.start_time}));this.selected.splice(t,1)},orderSelect:function(){this.selected.sort((function(e,t){return e.address_id==t.address_id?parseInt(e.start_time.replace(/:00/,""))<parseInt(t.start_time.replace(/:00/,""))?-1:1:parseInt(e.address_id)<parseInt(t.address_id)?-1:1})),console.log(this.selected)},bottomHeigth:function(){var t=this,c=this;setTimeout((function(){var n=e.createSelectorQuery().in(t);n.select("#appointmentBottm").boundingClientRect((function(e){c.bootomheight=e.height})).exec()}),100)},continueToApp:function(){this.addSelected(this.currentArea,this.currentObj,this.currentKeyword),this.bottomHeigth()},confirmApp:function(){this.show1=!0},emptyClick:function(){var e=this;this.selected=[],this.isWeekend?this.weekendTime.forEach((function(t){t.areaNames.forEach((function(t){e.$set(t,"select",!1)}))})):this.weekTime.forEach((function(t){t.areaNames.forEach((function(t){e.$set(t,"select",!1)}))})),console.log(),this.bootomheight=60},goPay:function(){var t=this,c=this.selected,i=this.userInfo.token;0==c.length?e.showToast({title:"您还没选场地",icon:"none"}):(c=c.map((function(e){return{address_id:e.address_id,start_time:(0,a.dealTime)(e.start_time),end_time:(0,a.dealTime)(e.end_time),peopleNum:1*t.picker[t.pickerIndex].replace("人","")}})),console.log(c),e.showLoading({title:""}),(0,n.appointmentOnline)(c,i).then((function(t){console.log(t),getApp().globalData.orderInfo=t,console.log(),e.reLaunch({url:"../succeed/succeed?id=1"})})).catch((function(t){t.data.msg?e.showToast({title:t.data.msg||"支付失败",icon:"none"}):e.showToast({title:"支付失败",icon:"none"})})))},allAppointment:function(){var e=this;(0,n.allAppointment)().then((function(t){var c=t;e.$refs.pullScroll.success(),e.isWeekend=1==c.time;var n=t.money;n.forEach((function(t){0==t.work_or_day?e.moneyDetail.weekMoney=t:1==t.work_or_day&&(e.moneyDetail.weekendMoney=t)})),console.log("价格获取成功"+e.moneyDetail),e.dealUnAble(c.result)}))},dealData:function(e){var t=(new Date).getHours();e.forEach((function(e){e.time.replace(/:00/,"")<t&&e.areaNames.forEach((function(e){e.canSelect=!1}))}))},dealUnAble:function(e){var t=e.filter((function(e){return 1==e.pay_status}));this.isWeekend?this.dealRed(t,this.weekendTime,this.moneyDetail.weekendMoney):this.dealRed(t,this.weekTime,this.moneyDetail.weekMoney)},PickerChange:function(e){this.pickerIndex=e.detail.value},dealRed:function(e,t,c){console.log(e);for(var n=this,a=e.filter((function(e){return 7==e.start_time})),i=(new Date).getHours(),l=0;l<t.length;l++){if("7:00"==t[l].time)for(var s=t[l].areaNames,r=0;r<s.length;r++)for(var d=0;d<a.length;d++)a[d].address_id==1*s[r].id+1&&(s[r].surplus+=a[d].people_num,s[r].surplus>=4&&this.$set(s[r],"canSelect",!1));else for(var o=0;o<e.length;o++)if(this.dealTimeStr(t[l].time)==e[o].start_time)for(var m=0;m<t[l].areaNames.length;m++){var u=t[l].areaNames[m];1*u.id+1==e[o].address_id&&n.$set(u,"canSelect",!1)}var f=t[l].time.replace(/:00/,"");this.isWeekend?f>=7&&f<9?t[l].price=c.morning_money:f>=9&&f<17?t[l].price=c.noon_money:f>=17&&f<21&&(t[l].price=c.night_money):f>=7&&f<10?t[l].price=c.morning_money:f>=10&&f<17?t[l].price=c.noon_money:f>=17&&f<21&&(t[l].price=c.night_money),f<i&&t[l].areaNames.forEach((function(e){e.canSelect=!1}))}},dealTimeStr:function(e){return e.replace(":00","")}}};t.default=o}).call(this,c("543d")["default"])},"72d7":function(e,t,c){"use strict";var n,a=function(){var e=this,t=e.$createElement;e._self._c},i=[];c.d(t,"b",(function(){return a})),c.d(t,"c",(function(){return i})),c.d(t,"a",(function(){return n}))},"7cb0":function(e,t,c){"use strict";var n=c("0d8b"),a=c.n(n);a.a},a101:function(e,t,c){"use strict";c.r(t);var n=c("2b24"),a=c.n(n);for(var i in n)"default"!==i&&function(e){c.d(t,e,(function(){return n[e]}))}(i);t["default"]=a.a},a4be:function(e,t,c){"use strict";(function(e){c("39d4"),c("921b");n(c("66fd"));var t=n(c("c22d"));function n(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,c("543d")["createPage"])},c22d:function(e,t,c){"use strict";c.r(t);var n=c("72d7"),a=c("a101");for(var i in a)"default"!==i&&function(e){c.d(t,e,(function(){return a[e]}))}(i);c("7cb0");var l,s=c("f0c5"),r=Object(s["a"])(a["default"],n["b"],n["c"],!1,null,"0de9421a",null,!1,n["a"],l);t["default"]=r.exports}},[["a4be","common/runtime","common/vendor"]]]);